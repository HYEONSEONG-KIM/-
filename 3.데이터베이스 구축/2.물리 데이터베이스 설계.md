# 물리 데이터 베이스 설계


## 90.사전 조사 분석
- 물리 데이터베이스 설계 : 논리적 구조로 표현된 논리적 데이터 베이스를 디스크 등의 물리적 저장장치에 저장할 수 있는 물리적 구조의 데이터로 변환하는 과정
    - 양식 설계, 레코드 집중의 분석 및 설계, 접근 경로 설계
    - 고려 사항 : 인덱스 구조, 레코드 크기, 레코드 개수, 파일에 대한 트랜잭션의 갱신과 참조 성향, 개념 스키마의 변경 여부 검토, 수행속도를 높이기 위한 고려, 시스템 운용 시 파일 크기의 변화 가능성
- 명명 규칙
    - 데이터 표준화 및 논리적 DB 설계의 결과물 등을 통해 파악
    - 물리 논리 DB설계에 규칙은 일관성 유지
    - 조직마다 다를 수 있음
    - 규칙을 통해 중복 구축 등을 방지
    - 도메인과 데이터 사전에 대한 지식이 필요
- 데이터 사전
    - 전체 프로젝트 과정에서 일관성 있는 데이터 이름과 인터페이스를 제공하기 위해 데이터 속성의 논리명, 물리명, 용어 정의를 기술해 놓은 것
    - 프로젝트에서 사용하는 명칭 부여의 근거로 사용
- 시스템 자원 파악 : 하드웨어 자원, 운영체제 및 DBMS 버전, DBMS 파라미터 정보 등을 미리 파악
- DB관리 요소 파악 : 데이터베이스 운영과 관련된 관리 요소로, 데이터베이스 시스템의 환경에 따라 달라질 수 있으므로 미리 파악


## 91.데이터베이스 저장 공간 설계
- 테이블(Table) : 데이터베이스의 가장 기본적인 객체로 로우와 컬럼으로 구성, 개체에 대응하는 객체
    - 일반 테이블 : 현재 사용하는 대부분의 DBMS에서 표준 테이블로 사용되는 테이블 형태
    - 클러스터드 인덱스 테이블(Clustered Index Table) : 기본키나 인덱스키의 순서에 따라 데이터가 저장되는 테이블
    - 파티셔닝 테이블(Partitioning Table) : 대용량의 테이블을 작은 논리적 단위인 파티션으로 나눈 테이블(범위 분할, 해시 분할, 조합 분할)
    - 외부 테이블(External Tabel) : DB에서 일반 테이블처럼 이용할 수 있는 외부 파일, DB 내에 객체로 존재
    - 임시 테이블(Temporary Table) :  트랜잭션이나 세션별로 데이터를 저장하고 처리할 수 있는 테이블
- 컬럼(Column) : 테이블의 열을 구성하는 요소로 데이터 타입, 길이 등으로 정의
- 테이블 스페이스(Tablespace) : 테이블이 저장되는 논리적인 영역으로, 하나의 테이블스페이스에 하나 또는 그 이상의 테이블을 저장


## 92.트랜잭션 분석/CRUD 분석
- 트랜잭션(Transaction) : DB의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위 또는 한꺼번에 수행되어야 할 일련의 연산들을 의미
- 트랜잭션 특징
    - Atomicity(원자성) : commit, rollback 둘중에 하나는 되어야 함, 모든 명령 완벽히 수행, 오류 하나라도 발생하면 전부 취소
    - Consistency(일관성) : 실행이 성공적으로 완료하면 일관성있는 DB의 상태로 변환
    - Isolation(독립성, 격리선, 순차성) : 둘 이상이 동시에 병행 실행되는 경우 어느 하나의 트랜잭션 실행 중에는 다른 트랜잭션의 연산에 끼어들 수 없음
    - Durability(영속성, 지속성) : 완료된 트랜잭션은 시스템이 고장 나더라도 영구적으로 반영
- CRUD 분석 : C(create) R(read) U(update) D(delete), CRUD 분석은 DB 테이블에 변화를 주는 트랜잭션의 CRUD연산에 대해 CRUD 매트릭스를 작성하여 분석
- CRUD 매트릭스 : 2차원 형태의 표, 행에는 프로세스, 열에는 테이블, 행과 열이 만나는 위치에는 프로세스가 테이블에 발생시키는 변화를 표시하는 업무 프로세스와 데이터 간 상관 분석표
- 트랜잭션 분석 : CRUD 매트릭스를 기반으로 테이블에 발생하는 트랜잭션 양을 분석하여 테이블에 저장되는 데이터의 양을 유추하고 이를 근거로 DB용량을 산정하고 DB구조를 최적화
- 트랜잭션 분석서 : 단위 프로세스와 CRUD 매트릭스를 이용하여 작성


## 93.인덱스 설계
- 인덱스(Index) : 데이터 레코드를 빠르게 접근하기 위해 <키 값, 포인터> 쌍으로 구성되는 데이터 구조
    - 물리적 구조와 연관
    - 인덱스 개수 최소화 하는게 효율적
    - 기본키를 위한 인덱스 -> 기본 인덱스, 나머지 -> 보조 인덱스
    - 엔트리 순서와 일치하게 유지되도록 구성 되는 인덱스 -> 클러스터드 인덱스
- 트리 기반 인덱스 : 인덱스를 저장하는 블록들이 트리 구조를 이루고 있는 것, 사용 DBMS에서는 트리 구조기반의 B+ 트리 인덱스 활용
    - B 트리 인덱스 : 루트 노드에서 하위 노드로 키 값의 크기를 비교해 나가면서 단말 노드에서 찾고자 하는 데이터 검색
    - B+ 트리 인덱스 : B트리의 변형, 단말 노드가 아닌 노드로 구성된 인덱스 세트와 단말 노드로만 구성된 순차 세트로 구분
- 비트맵 인덱스 : 인덱스 컬럼의 데이터를 Bit 값인 0 또는 1로 변환하여 인덱스 키로 사용하는 방법
- 함수 기반 인덱스 : 컬럼의 값 대신 컬럼에 특정 함수나 수식을 적용하여 산출된 값을 사용, B+ 트리 인덱스 또는 비트맵 인덱스를 생성하여 사용
- 비트맵 조인 인덱스 : 다수의 조인된 객체로 구성된 인덱스, 단일 객체로 구성된 일반적인 인덱스와 액세스 방법이 다름
- 도메인 인덱스 : 개발자가 필요한 인덱스를 직접 만들어 사용하는 것으로, 확장형 인덱스 라고도 함
- 인덱스 설계 : 인덱스의 대상 테이블이나 컬럼 선정 -> 인덱스의 효율성을 검토하여 인덱스 최적화 수행 -> 인덱스 정의서 작성
- 인덱스 대상 테이블 선정 기준
    - MULTI BLOCK READ 수에 따라 판단
    - 랜덤 액서스가 빈번한 테이블
    - 특정 범위나 특정 순서로 데이터 조회가 필요한 테이블
    - 다른 테이블과 순차적 조인이 발생되는 테이블
- 인덱스 대상 컬럼 선정 기준
    - 분포도가 10~15% 이내인 컬럼
    - 분포도 범위가 넓어도 부분 처리를 목적으로 하는 컬럼
    - 기본키와 유니크키 제약조건을 사용한 컬럼
    - 분포도가 좁은 컬럼은 단독 인덱스로 생성
    - 자주 조회되어 사용되는 경우 하나의 결합 인덱스로 생성
- 인덱스 설계 시 고려사항
    - 인덱스가 지나치게 많으면 오버헤드 발생
    - 인덱스 테이블과 데이터의 저장 공간이 분리 되도록 설계